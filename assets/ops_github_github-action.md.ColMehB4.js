import{_ as c}from"./chunks/ArticleMetadata.DwOS4yrW.js";import{_ as o,D as g,c as b,I as l,w as t,j as d,a as D,a9 as r,o as n,b as h,e as k}from"./chunks/framework.B6pjmo9y.js";const x=JSON.parse('{"title":"Github Actions","description":"","frontmatter":{},"headers":[],"relativePath":"ops/github/github-action.md","filePath":"ops/github/github-action.md","lastUpdated":1716434902000}'),A={name:"ops/github/github-action.md"},u=d("h1",{id:"github-actions",tabindex:"-1"},[D("Github Actions "),d("a",{class:"header-anchor",href:"#github-actions","aria-label":'Permalink to "Github Actions"'},"​")],-1),y=r(`<h2 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h2><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffeatures%2Factions" title="https://github.com/features/actions" target="_blank" rel="noreferrer">GitHub Actions</a> 是 <code>GitHub</code> 的持续集成服务， <strong>可用于自动执行生成、测试和部署</strong>，非常强大</p><p><code>GitHub</code> 还允许开发者将自己的脚本，放到代码仓库，供其他开发者引用。如果你需要某个 <code>action</code>，不必自己写复杂的脚本，直接引用他人写好的 <code>action</code> 即可，整个持续集成过程，就变成了一个 <code>actions</code> 的组合。这就是 <code>GitHub Actions</code> 最特别的地方</p><p><code>GitHub</code> 做了一个<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmarketplace%3Ftype%3Dactions" title="https://github.com/marketplace?type=actions" target="_blank" rel="noreferrer">官方市场</a>，可以搜索到他人提交的 <code>actions</code>。另外，还有一个 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsdras%2Fawesome-actions" title="https://github.com/sdras/awesome-actions" target="_blank" rel="noreferrer">awesome actions</a> 的仓库，也可以找到不少 <code>action</code></p><h2 id="基本概念" tabindex="-1">基本概念 <a class="header-anchor" href="#基本概念" aria-label="Permalink to &quot;基本概念&quot;">​</a></h2><p>GitHub Actions 有一些自己的术语。</p><ul><li><strong>workflow</strong> （工作流程）：持续集成一次运行的过程，就是一个 workflow</li><li><strong>job</strong> （任务）：一个 workflow 由一个或多个 jobs 构成，含义是一次持续集成的运行，可以完成多个任务</li><li><strong>step</strong>（步骤）：每个 job 由多个 step 构成，一步步完成</li><li><strong>action</strong> （动作）：每个 step 可以依次执行一个或多个命令（action）</li></ul><h2 id="workflow-文件" tabindex="-1">workflow 文件 <a class="header-anchor" href="#workflow-文件" aria-label="Permalink to &quot;workflow 文件&quot;">​</a></h2><p><code>GitHub Actions</code> 的配置文件叫做 <code>workflow</code> 文件，存放在代码仓库的 ** <code>项目根目录 &gt; .github &gt; workflows</code>** 目录，如果你的项目没有这两个目录(<code>&amp;#x9ED8;&amp;#x8BA4;&amp;#x662F;&amp;#x6CA1;&amp;#x6709;&amp;#x7684;</code>)，则需要自行创建，如果有可以跳过这一步</p><p><code>workflow</code> 文件采用 <code>YAML</code> 格式，文件名可以任意取，但是后缀名统一为 <code>.yml</code>，比如 <code>foo.yml</code>。一个库可以有多个 workflow 文件</p><p>** <code>Github</code> 会自动读取这个目录下的文件，根据其规则自动运行该文件**，所以你想要执行哪个脚本，放在这个目录下，写好执行规则（设置好条件为条件触发或是手动触发），推送到 <code>Github</code> 就行了</p><p><code>workflow</code> 文件的配置字段非常多，这里介绍一下 <code>on</code> 字段， <code>on</code> 字段指定触发 <code>workflow</code> 的条件，通常是某些事件，也可以设置为仅手动触发</p><div class="language-yml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  push</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    branches</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [ </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;master&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  workflow_dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>其他字段详见阮一峰的这篇文章：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2019%2F09%2Fgetting-started-with-github-actions.html" title="https://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html" target="_blank" rel="noreferrer">GitHub Actions 入门教程</a></p><h1 id="自动部署-github-pages" tabindex="-1">自动部署 Github Pages <a class="header-anchor" href="#自动部署-github-pages" aria-label="Permalink to &quot;自动部署 Github Pages&quot;">​</a></h1>`,15),m=r(`<p><strong><code>Github Pages</code> 有两种使用方式</strong></p><p>提示：只是部署 <code>Github Pages</code> 的话， <strong>无须 <code>key</code> 、 <code>token</code> 之类的，直接复制我的脚本代码就可以了</strong>，网上有的老教程还需要 <code>token</code> ....</p><p><strong>其他的 <code>Actions</code> 需要什么 <code>key</code> 、 <code>token</code> 的时候我会特别标注</strong></p><h2 id="一、自动打包并部署-不需要打包后的文件。-source-设置为-github-actions" tabindex="-1">一、自动打包并部署，不需要打包后的文件。 <code>Source</code> 设置为 <code>Github Actions</code> <a class="header-anchor" href="#一、自动打包并部署-不需要打包后的文件。-source-设置为-github-actions" aria-label="Permalink to &quot;一、自动打包并部署，不需要打包后的文件。 \`Source\` 设置为 \`Github Actions\`&quot;">​</a></h2><p><strong>适用于只使用 <code>Github Pages</code> 的用户</strong></p><h3 id="脚本代码" tabindex="-1">脚本代码 <a class="header-anchor" href="#脚本代码" aria-label="Permalink to &quot;脚本代码&quot;">​</a></h3><p>这份脚本代码 <strong>不需要设置任何变量，直接复制就能用</strong>。 如果你的打包目录是不是 <code>dist</code>，不是的话要改成你的 如果你不需要 <code>pnpm</code>，可以把 <code>Install pnpm</code> 这一步去掉，并把后面的 <code>pnpm</code> 改成 <code>npm</code></p><div class="language-yml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Deploy Github Pages1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  push</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    branches</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [ </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;master&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  workflow_dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">permissions</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  contents</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">write</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  pages</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">write</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  id-token</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">write</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">jobs</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  deploy</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">      name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">github-pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">      url</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">\${{ steps.deployment.outputs.page_url }}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    runs-on</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    steps</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Checkout</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">actions/checkout@v3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Install pnpm</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">pnpm/action-setup@v2</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          version</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Set up Node</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">actions/setup-node@v3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          node-version</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">18</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          cache</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;pnpm&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Install dependencies</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        run</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">pnpm install</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Build</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        run</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">pnpm run build</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Setup Pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">actions/configure-pages@v3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Upload artifact</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">actions/upload-pages-artifact@v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          path</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;./dist&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Deploy to GitHub Pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        id</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">deployment</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">actions/deploy-pages@v1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h3 id="一、设置-pages-来源" tabindex="-1">一、设置 <code>Pages</code> 来源 <a class="header-anchor" href="#一、设置-pages-来源" aria-label="Permalink to &quot;一、设置 \`Pages\` 来源&quot;">​</a></h3><p>在仓库设置的 <code>Pages</code> 功能里，将其 <code>Source</code> 设置为 <code>Github Actions</code></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f796951d15854dff9cdcbcfa2f335117~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1232&amp;h=687&amp;s=91294&amp;e=png&amp;b=ffffff" alt=""></p><h3 id="二、推送脚本" tabindex="-1">二、推送脚本 <a class="header-anchor" href="#二、推送脚本" aria-label="Permalink to &quot;二、推送脚本&quot;">​</a></h3><p>将脚本放到 <strong><code>项目根目录 &gt; .github &gt; workflows</code></strong> 目录下并推送到 <code>Github</code>，脚本会自动运行</p><h3 id="三、查看脚本是否成功执行" tabindex="-1">三、查看脚本是否成功执行 <a class="header-anchor" href="#三、查看脚本是否成功执行" aria-label="Permalink to &quot;三、查看脚本是否成功执行&quot;">​</a></h3><p>点到仓库的 <code>Actions</code> 界面，就可以看到我们所有的 <code>Actions</code> 脚本，和脚本运行状态，点进每个任务里面可以查看运行详细流程和重新运行脚本(需要在脚本里面声明 <code>workflow_dispatch</code>) ，如果没报错，就可以去项目 <code>Setting</code> 里面查看 <code>Github Pages</code> 的地址了</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0a9427f12e4f423584623305f0e5908b~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2483&amp;h=936&amp;s=216392&amp;e=png&amp;b=ffffff" alt=""></p><h3 id="四、查看-github-pages-访问地址" tabindex="-1">四、查看 <code>Github Pages</code> 访问地址 <a class="header-anchor" href="#四、查看-github-pages-访问地址" aria-label="Permalink to &quot;四、查看 \`Github Pages\` 访问地址&quot;">​</a></h3><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d3791f7cd25b499e9cb287adf7ed413a~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2124&amp;h=1006&amp;s=180372&amp;e=png&amp;b=ffffff" alt=""></p><h2 id="二、自动打包-将打包后的文件推送到指定分支。-source-需要设置为-deploy-from-a-branch" tabindex="-1">二、自动打包，将打包后的文件推送到指定分支。 <code>Source</code> 需要设置为 <code>Deploy from a branch</code> <a class="header-anchor" href="#二、自动打包-将打包后的文件推送到指定分支。-source-需要设置为-deploy-from-a-branch" aria-label="Permalink to &quot;二、自动打包，将打包后的文件推送到指定分支。 \`Source\` 需要设置为 \`Deploy from a branch\`&quot;">​</a></h2><p><strong>适用于同时需要使用 <code>Gitee Pages</code> 的用户</strong> 这种方式可以把 <code>Github Pages</code> 想象成 <code>nginx</code>，指定的某个分支便是 <code>nginx</code> 的项目目录。当我们打包后， <code>Ations</code> 把打包文件放到指定分支，我们就能访问了。同时当我们同步代码到 <code>Gitee</code> 时，也会把所有分支的代码同步过去， <code>Gitee</code> 也可以部署 <code>Pages</code></p><p>我们需要打包后生成的文件，则需要用到 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpeaceiris%2Factions-gh-pages" title="https://github.com/peaceiris/actions-gh-pages" target="_blank" rel="noreferrer">peaceiris/actions-gh-pages@v4</a> 这个 <code>Actions</code>，它可以将打包后的文件推送到指定分支</p><h3 id="脚本代码-1" tabindex="-1">脚本代码 <a class="header-anchor" href="#脚本代码-1" aria-label="Permalink to &quot;脚本代码&quot;">​</a></h3><p>这份脚本代码 <strong>不需要设置任何变量，直接复制就可以用，里面的GITHUB_TOKEN不需要我们去定义，Actions 会处理</strong>。</p><p>同样要注意你的打包目录是不是 <code>dist</code>，不是的话要改成你的，另外脚本里面默认将打包文件推送到 <code>gh-pages</code> 分支，可以自定义</p><div class="language-yml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Deploy GitHub Pages2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  push</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    branches</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [ </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;master&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  workflow_dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">permissions</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  contents</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">write</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  pages</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">write</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  id-token</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">write</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">jobs</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  deploy</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">      name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">github-pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">      url</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">\${{ steps.deployment.outputs.page_url }}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    runs-on</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    steps</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Checkout</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">actions/checkout@v3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Install pnpm</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">pnpm/action-setup@v2</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          version</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Set up Node</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">actions/setup-node@v3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          node-version</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">18</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          cache</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;pnpm&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Install dependencies</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        run</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">pnpm install</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Build</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        run</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">pnpm run build</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Deploy to Github Pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">peaceiris/actions-gh-pages@v4</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          github_token</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">\${{ secrets.GITHUB_TOKEN  }}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          publish_dir</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">./dist</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          publish_branch</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">gh-pages</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h3 id="一、创建-gh-pages-分支-设置-pages-来源" tabindex="-1">一、创建 <code>gh-pages</code> 分支， 设置 <code>Pages</code> 来源 <a class="header-anchor" href="#一、创建-gh-pages-分支-设置-pages-来源" aria-label="Permalink to &quot;一、创建 \`gh-pages\` 分支， 设置 \`Pages\` 来源&quot;">​</a></h3><p>创建一个用于存放打包文件的分支 <code>gh-pages</code>，并在仓库设置的 <code>Pages</code> 选择里面，将 <code>Source</code> 设置为 <code>Deploy from a branch</code> ，然后将 <code>Branch</code> 选项设置为刚刚创建的分支，最后点击 <code>Save</code> 保存</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0e49330b2db0495084ff80530a8d5999~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1610&amp;h=997&amp;s=134737&amp;e=png&amp;b=ffffff" alt=""></p><h3 id="二、推送脚本-1" tabindex="-1">二、推送脚本 <a class="header-anchor" href="#二、推送脚本-1" aria-label="Permalink to &quot;二、推送脚本&quot;">​</a></h3><p>将脚本放到 <strong><code>项目根目录 &gt; .github &gt; workflows</code></strong> 目录下并推送到 <code>Github</code>，脚本会自动运行</p><h3 id="三、查看脚本是否成功执行-1" tabindex="-1">三、查看脚本是否成功执行 <a class="header-anchor" href="#三、查看脚本是否成功执行-1" aria-label="Permalink to &quot;三、查看脚本是否成功执行&quot;">​</a></h3><p>等 <code>Actions</code> 执行完了，刷新一下项目，会发现多了一个分支</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/68f793c6bc864917927b2ef1ece29dec~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=640&amp;h=512&amp;s=36662&amp;e=png&amp;b=ffffff" alt=""></p><h3 id="四、查看-github-pages-访问地址-1" tabindex="-1">四、查看 <code>Github Pages</code> 访问地址 <a class="header-anchor" href="#四、查看-github-pages-访问地址-1" aria-label="Permalink to &quot;四、查看 \`Github Pages\` 访问地址&quot;">​</a></h3><p>同第一种方式，这里不在赘述</p><h1 id="同步代码到-gitee" tabindex="-1">同步代码到 Gitee <a class="header-anchor" href="#同步代码到-gitee" aria-label="Permalink to &quot;同步代码到 Gitee&quot;">​</a></h1>`,36),F=r(`<h2 id="脚本代码-2" tabindex="-1">脚本代码 <a class="header-anchor" href="#脚本代码-2" aria-label="Permalink to &quot;脚本代码&quot;">​</a></h2><p>需要用下面这个 <code>Actions</code>，它是专门用于同步代码到 <code>Gitee</code> 的。 我们只需把下面代码添加到 &quot;自动部署 Github Pages&quot; 第二种方式的脚本代码后面就可以了</p><div class="language-yml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Sync to Gitee</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">wearerequired/git-mirror-action@master</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  env</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">    // ssh 私钥</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    SSH_PRIVATE_KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">\${{ secrets.GITEE_PRIVATE_KEY }}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">    // 仓库源地址</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    source-repo</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">git@github.com:zyronon/douyin.git</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">    // gitee 的仓库地址</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    destination-repo</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">git@gitee.com:zyronon/douyin.git</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>同步到 <code>Gitee</code> 需要配置 <code>SSH Key</code> ，即 <strong>私钥和公钥</strong>，如何生成 <code>SSH Key</code> ？参考<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.github.com%2Fen%2Fauthentication%2Fconnecting-to-github-with-ssh%2Fgenerating-a-new-ssh-key-and-adding-it-to-the-ssh-agent" title="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent" target="_blank" rel="noreferrer">这篇文章</a></p><blockquote><p>生成 <code>SSH key</code> 的命令：ssh-keygen -t ed25519 -C &quot;<a href="https://link.juejin.cn?target=mailto%3Ayour_email%40example.com" title="mailto:your_email@example.com" target="_blank" rel="noreferrer">your_email@example.com</a>&quot;</p></blockquote><p>生成的 <code>SSH Key</code> 默认在 <code>C</code> 盘的用户目录下的 <code>.ssh</code> 目录下 比如说你的用户名叫：abc，就是 <code>C:\\Users\\abc/.ssh/</code> 目录</p><h2 id="一、-github-项目中添加私钥" tabindex="-1">一、 <strong>Github</strong> 项目中添加私钥 <a class="header-anchor" href="#一、-github-项目中添加私钥" aria-label="Permalink to &quot;一、 **Github** 项目中添加私钥&quot;">​</a></h2><p>在 <strong>Github</strong> 的 <strong>项目设置</strong> 里面添加一个 <code>Actions</code> 的 <code>secrets</code> ，名字叫 <code>GITEE_PRIVATE_KEY</code>，内容是我们生成的私钥</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d248d4ce326440439eb1a6284b08b0cb~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2049&amp;h=1191&amp;s=197630&amp;e=png&amp;b=ffffff" alt=""></p><blockquote><p>注意：复制私钥的时候，要把开头结尾的内容也加上。 -----BEGIN OPENSSH PRIVATE KEY----- -----END OPENSSH PRIVATE KEY-----</p></blockquote><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/66c1a2c0cc444e5bbab6b640a9fc675d~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1278&amp;h=658&amp;s=80424&amp;e=png&amp;b=ffffff" alt=""></p><h2 id="二、-github-个人设置里面添加公钥" tabindex="-1">二、 <strong>Github</strong> 个人设置里面添加公钥 <a class="header-anchor" href="#二、-github-个人设置里面添加公钥" aria-label="Permalink to &quot;二、 **Github** 个人设置里面添加公钥&quot;">​</a></h2><p>在 <strong>Github</strong> 的 <strong>个人设置</strong> 里面添加一个公钥 ，名字叫 <code>GITEE_PUB_KEY</code>，内容是我们生成的公钥</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7566cba7a2884a568b9f9dc0cf25e965~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2063&amp;h=937&amp;s=177495&amp;e=png&amp;b=e6e9eb" alt=""></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3f53c6bc56d0416d829967cb10552508~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1277&amp;h=676&amp;s=41215&amp;e=png&amp;b=ffffff" alt=""></p><h2 id="三、-gitee-个人设置里面添加公钥" tabindex="-1">三、 <strong>Gitee</strong> 个人设置里面添加公钥 <a class="header-anchor" href="#三、-gitee-个人设置里面添加公钥" aria-label="Permalink to &quot;三、 **Gitee** 个人设置里面添加公钥&quot;">​</a></h2><p>同第二步，名字也叫 <code>GITEE_PUB_KEY</code>，内容也是我们生成的公钥</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/748514201e494a8bb957c8879027044e~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1550&amp;h=930&amp;s=111857&amp;e=png&amp;b=ffffff" alt=""></p><h2 id="四、将脚本推送到-github" tabindex="-1">四、将脚本推送到 <code>Github</code> <a class="header-anchor" href="#四、将脚本推送到-github" aria-label="Permalink to &quot;四、将脚本推送到 \`Github\`&quot;">​</a></h2><p>把脚本代码复制到 <strong><code>项目根目录 &gt; .github &gt; workflows</code></strong> 目录下并推送到 <code>Github</code>，等待执行结果即可</p><h1 id="自动部署-gitee-pages" tabindex="-1">自动部署 Gitee Pages <a class="header-anchor" href="#自动部署-gitee-pages" aria-label="Permalink to &quot;自动部署 Gitee Pages&quot;">​</a></h1>`,21),C=r(`<p>截至写稿日期：2024/5/7 ， <code>Gitee Pages</code> 一直无法使用中，据说是下线了😅 不过我还是决定把教程分享出来，说不定以后又可以使用了</p><h2 id="脚本代码-3" tabindex="-1">脚本代码 <a class="header-anchor" href="#脚本代码-3" aria-label="Permalink to &quot;脚本代码&quot;">​</a></h2><p>在上一个 <code>Actions</code> 中，我们已经把代码同步到 <code>Gitee</code> 了，现在只需要在脚本后面添加触发 <code>Gitee Pages</code> 部署的代码就可以了</p><p>里面用到 <code>yanglbme/gitee-pages-action@main</code> 这个 <code>Actions</code> ，它是专门用于触发 <code>Gitee Pages</code> 部署的</p><div class="language-yml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Build Gitee Pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">yanglbme/gitee-pages-action@main</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    gitee-username</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">zyronon</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    gitee-password</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">\${{ secrets.GITEE_PASSWORD }}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    gitee-repo</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">zyronon/douyin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    branch</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">gitee-pages</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>我们需要在项目里面配置一个 <code>GITEE_PASSWORD</code> 变量，值是你 <code>Gitee</code> 的密码，配置过程和前面的一样，这里不再赘述</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2694691def524375be787c8ca6ed19f3~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2009&amp;h=1191&amp;s=193817&amp;e=png&amp;b=ffffff" alt=""></p><p>然后推送到 <code>Github</code> ，等待执行结果即可</p><h2 id="绕过-gitee-pages-审核" tabindex="-1">绕过 <code>Gitee Pages</code> 审核 <a class="header-anchor" href="#绕过-gitee-pages-审核" aria-label="Permalink to &quot;绕过 \`Gitee Pages\` 审核&quot;">​</a></h2><p>当部署时， <code>Gitee Pages</code> 会对所有内容审查，不符合要求的会被拒绝。</p><p>像我这个 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzyronon%2Fdouyin" title="https://github.com/zyronon/douyin" target="_blank" rel="noreferrer"><strong>模仿抖音</strong></a> 的项目，里面的 <code>json</code> 数据总是被提醒有敏感内容，我一个 <code>json</code> 4M多，我怎么改啊 - -</p><p>后面我新建了一个项目，里面放了一些 <code>zip</code> 文件，发现 <code>Github Pages</code> 不会审查，但同时也会被过滤掉，它似乎是白名单机制，只允许指定后缀的文件</p><p>然后我又试了一试，把 <code>json</code> 压缩成 <code>zip</code> 包后，修改文件后缀为 <code>md</code>，伪装成是个 <code>markdown</code> 文件，部署试了试，果然没问题，直接跳过了审查</p><p>问题来了，前端怎么把压缩包解压呢？？？</p><h3 id="libarchive-wasm-库" tabindex="-1">libarchive-wasm 库 <a class="header-anchor" href="#libarchive-wasm-库" aria-label="Permalink to &quot;libarchive-wasm 库&quot;">​</a></h3><p>这里给大家介绍一个库 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Flibarchive-wasm" title="https://www.npmjs.com/package/libarchive-wasm" target="_blank" rel="noreferrer">libarchive-wasm</a>，这个库可以解压 <code>zip</code> 、 <code>7z</code> 等格式</p><p>我这里写一个工具方法 <code>_fetch</code>，代替 <code>fetch</code> 使用，如果你用 <code>axios</code> ，原理也差不多</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> { ArchiveReader, libarchiveWasm } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;libarchive-wasm&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> _fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> Promisejson</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> Response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">IS_DEV</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> || !</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">IS_GITEE_PAGES</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> url.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;.md&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;.json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(url)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">  } else {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(url)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (url.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;.md&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> r.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">arrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> mod</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> libarchiveWasm</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> reader</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> ArchiveReader</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(mod, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> Int8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(data))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> entry</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> reader.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">entries</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">()) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">          if</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (entry.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">getPathname</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">endsWith</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;.json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">            const</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> TextDecoder</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">decode</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(entry.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">readData</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">())</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">            resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">              json</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">                return</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(data))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">              }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">          }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        reader.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">free</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">        resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(r)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>同时需要在 <code>public</code> 目录下放 <code>libarchive.wasm</code> 这个文件，😅😅😅 作者也没说要放，但不放无法解压！ 这个文件在 <code>node_modules</code> 下面，复制出来放在 <code>public</code> 目录下就可以了</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1d997920161349c2b60960a9ad1a1911~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=484&amp;h=627&amp;s=41179&amp;e=png&amp;b=3d3223" alt=""></p><h1 id="翻译-readme-md" tabindex="-1">翻译 README.MD <a class="header-anchor" href="#翻译-readme-md" aria-label="Permalink to &quot;翻译 README.MD&quot;">​</a></h1>`,21),B=r(`<p>直接用下面这个脚本就行，要什么语言自己在里面加 语言代码: <a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.google.com%2Ftranslate%2Fdocs%2Flanguages" title="https://cloud.google.com/translate/docs/languages" target="_blank" rel="noreferrer">cloud.google.com/translate/d...</a> 无需其他步骤，直接复制到目录下，推送到 <code>Github</code> 就可以用，需注意这个脚本我设置为了 <code>&amp;#x624B;&amp;#x52A8;&amp;#x89E6;&amp;#x53D1;</code></p><div class="language-yml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Translate README</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  workflow_dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">jobs</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  build</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    runs-on</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    steps</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">actions/checkout@v2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Setup Node.js</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">actions/setup-node@v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          node-version</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">12.x</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Adding README - English</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">dephraiim/translate-readme@main</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          LANG</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">en</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Adding README - Japanese</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">dephraiim/translate-readme@main</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          LANG</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">ja</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Adding README - German</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">dephraiim/translate-readme@main</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          LANG</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">de</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Adding README - French</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">dephraiim/translate-readme@main</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          LANG</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">fr</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Adding README - Spanish</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">dephraiim/translate-readme@main</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          LANG</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">es</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h1 id="打包-docker-镜像" tabindex="-1">打包 docker 镜像 <a class="header-anchor" href="#打包-docker-镜像" aria-label="Permalink to &quot;打包 docker 镜像&quot;">​</a></h1>`,3),E=r(`<h2 id="脚本代码-4" tabindex="-1">脚本代码 <a class="header-anchor" href="#脚本代码-4" aria-label="Permalink to &quot;脚本代码&quot;">​</a></h2><div class="language-yml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">Docker Image CI</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  push</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    tags</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">v*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  workflow_dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">jobs</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  build</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    runs-on</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    steps</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">get version</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        id</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">vars</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        run</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">echo ::set-output name=version::\${GITHUB_REF/refs/tags/v/}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">actions/checkout@v4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">set up QEMU</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">docker/setup-qemu-action@v3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">set up docker buildx</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">docker/setup-buildx-action@v3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">login ghrc hub</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">docker/login-action@v3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          registry</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">ghcr.io</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          username</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">\${{ github.repository_owner }}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          password</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">\${{ secrets.GHCR_TOKEN }}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">build and push</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">docker/build-push-action@v5</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          push</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          platforms</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">linux/amd64,linux/arm64</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">          tags</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">            ghcr.io/\${{ github.repository_owner }}/你的项目名（或者你想取的镜像名）:\${{ steps.vars.outputs.version }}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">            ghcr.io/\${{ github.repository_owner }}/你的项目名（或者你想取的镜像名）:latest</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="设置-ghcr-token" tabindex="-1">设置 GHCR_TOKEN <a class="header-anchor" href="#设置-ghcr-token" aria-label="Permalink to &quot;设置 GHCR_TOKEN&quot;">​</a></h2><p>需要注意的是，里面的 <code>GHCR_TOKEN</code> 变量，同样需要自己在项目里面添加，同前面一样，这里不在赘述</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/734d8e4327934262b44beddc73ee7c61~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1465&amp;h=950&amp;s=117864&amp;e=png&amp;b=ffffff" alt=""></p><p><code>GHCR_TOKEN</code> 变量的值是你自己 <code>Github</code> 账号的 <code>token</code>，需要在个人设置里面生成一个 <code>token</code> ，最好选择 <code>Generate new token (classic)</code>，把权限都够选上，设置 <code>token</code>不过期 设置链接：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsettings%2Ftokens" title="https://github.com/settings/tokens" target="_blank" rel="noreferrer">github.com/settings/to...</a></p><h2 id="dockerfile" tabindex="-1">Dockerfile <a class="header-anchor" href="#dockerfile" aria-label="Permalink to &quot;Dockerfile&quot;">​</a></h2><p><code>Dockerfile</code> 是一个用来构建镜像的文本文件，文本内容包含了一条条构建镜像所需的指令和说明。</p><p>我们可以安装在 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.docker.com%2F" title="https://www.docker.com/" target="_blank" rel="noreferrer">www.docker.com/</a> 安装 <code>docker desktop</code> 来本地构建镜像，本地没问题再推送到 <code>Github</code> 上</p><p><code>Dockerfile</code>文件代码</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --platform=\${</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">BUILDPLATFORM</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">:-</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">linux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">amd64</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">linux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">arm64</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> node:20-buster</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> AS</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> builder</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">WORKDIR</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /src</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">COPY</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ./</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ./</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">RUN</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> npm</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> install</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">RUN</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> npm</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --platform=\${</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">BUILDPLATFORM</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">:-</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">linux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">amd64</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">linux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">arm64</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ghcr.io/rookie-luochao/nginx-runner:latest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">COPY</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --from=builder</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /src/dist</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /app</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="推送到-github" tabindex="-1">推送到 Github <a class="header-anchor" href="#推送到-github" aria-label="Permalink to &quot;推送到 Github&quot;">​</a></h2><p>和前面一样，推送到 <code>Github</code> 就可以了，不过这次比较特别，我们写的触发时机是当有 <code>git tag</code> 推送时才会触发</p><p>因为 <code>docker</code> 镜像一般都需要版本号，所以触发工作流的时机为打 <code>tag</code> 触发 <code>docker</code> 镜像构建</p><div class="language-yml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  push</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">    tags</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">v*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">  workflow_dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>所以这次推送上去，并不会触发 <code>Actions</code> 运行。如果我们手动去运行 <code>Actions</code> 的话会报错， 因为找不到 <code>git tag</code></p><p>所以需要在本地新建一个 <code>tag</code> ，推送到 <code>github</code> 上后， <code>Actions</code> 才会执行</p><h2 id="排坑" tabindex="-1">排坑 <a class="header-anchor" href="#排坑" aria-label="Permalink to &quot;排坑&quot;">​</a></h2><p>我之前在本地构建镜像每次都成功，但在 <code>Github Actions</code> 执行时的容器里，一直报错 参考我前面写的这篇文章：<a href="https://juejin.cn/post/7363574375625228323" title="https://juejin.cn/post/7363574375625228323" target="_blank" rel="noreferrer">我发现了 Vite 的一个 Bug</a></p><h2 id="发布-docker-镜像" tabindex="-1">发布 docker 镜像 <a class="header-anchor" href="#发布-docker-镜像" aria-label="Permalink to &quot;发布 docker 镜像&quot;">​</a></h2><p>如果我们的 <code>Github Actions</code> 执行成功没报错的话，那么在我们个人主页的 <code>Pageages</code> 这个页面下，就会看到一个 <code>docker</code> 镜像</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6c5b311bc6944d7e9536ea172625b574~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2458&amp;h=748&amp;s=379472&amp;e=png&amp;b=ffffff" alt=""></p><p>注意：镜像第一次推送到 <code>ghrc</code> 时，默认是私有的，别人是无法 <code>pull</code> 的，还需要我们点进去把权限改为 <code>Public</code></p><p><code>docker</code> 镜像地址为：ghcr.io/你的github用户名/项目名:latest</p><p>例如：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ghcr.io/zyronon/douyin-vue:latest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 80:80</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ghcr.io/zyronon/douyin-vue:latest</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h1 id="结束" tabindex="-1">结束 <a class="header-anchor" href="#结束" aria-label="Permalink to &quot;结束&quot;">​</a></h1>`,27),f=d("blockquote",null,[d("p",null,"以上就是文章的全部内容，感谢看到这里，希望对你有所帮助或启发！创作不易，如果觉得文章写得不错，可以点赞收藏支持一下，我会更新更多实用的前端知识与技巧，期待与你共同成长~")],-1);function w(s,_,v,P,j,G){const e=c,p=g("ClientOnly");return n(),b("div",null,[u,l(p,null,{default:t(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),h(e,{key:0,article:s.$frontmatter},null,8,["article"])):k("",!0)]}),_:1}),y,l(p,null,{default:t(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),h(e,{key:0,article:s.$frontmatter},null,8,["article"])):k("",!0)]}),_:1}),m,l(p,null,{default:t(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),h(e,{key:0,article:s.$frontmatter},null,8,["article"])):k("",!0)]}),_:1}),F,l(p,null,{default:t(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),h(e,{key:0,article:s.$frontmatter},null,8,["article"])):k("",!0)]}),_:1}),C,l(p,null,{default:t(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),h(e,{key:0,article:s.$frontmatter},null,8,["article"])):k("",!0)]}),_:1}),B,l(p,null,{default:t(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),h(e,{key:0,article:s.$frontmatter},null,8,["article"])):k("",!0)]}),_:1}),E,l(p,null,{default:t(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),h(e,{key:0,article:s.$frontmatter},null,8,["article"])):k("",!0)]}),_:1}),f])}const S=o(A,[["render",w]]);export{x as __pageData,S as default};
